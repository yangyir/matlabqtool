%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 以1980年1月1日所处周为第一周，本函数计算任一大于1980年1月1日的日期所出周数
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function n = week_num(d,w)
% 若为字符型日期，则转换成数值型日期
if ~isa(d,'numeric')
    d =datenum(d);
end

yrs = 1980;
dFirst = datenum(yrs,1,1);
nDay = mod(fix(dFirst)-2,7)-(w-1);
n = fix((d - dFirst + nDay)./7)+1;
end